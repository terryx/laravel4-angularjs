angular.module("Video",["ngSanitize","ui.bootstrap","Router","Service","Api"]).controller("VideoFeeds",["$scope","$http","$location","dataStorage",function(a,d,c,b){a.artist="";a.artists=b.video.artist;a.getFeeds=function(e){var f="https://gdata.youtube.com/feeds/api/users/"+e+"/uploads?alt=json";jQuery.ajax({type:"GET",url:f,success:function(l){var h=l.feed["entry"];var k=[];for(var j=0,g=h.length;j<g;j++){k.push({url:h[j]["link"][0]["href"],title:h[j]["media$group"]["media$title"]["$t"],thumbnail:h[j]["media$group"]["media$thumbnail"][0]["url"]})}d.get("https://gdata.youtube.com/feeds/api/videos/rv8C1wjbsKw?alt=json").success(function(i){}).error(function(m,i){a.rows=k})}})};$.ajax({url:adasd,});a.videoModal=function(e){console.log(e)};a.searchArtist=function(){a.getFeeds(a.artist)}}]).controller("VideoAdd",["$scope","$routeParams","Video","$location","dataStorage",function(b,d,a,e,c){b.url="";b.visibility="true";b.visibilityChecked=true;b.error="";b.alert=false;b.type="";b.types=c.video.type;b.rows=[];b.showContent=function(f){f.updated_at=moment(["updated_at"]).fromNow();b.rows.push(f)};b.submit=function(){if(b.url===""){b.error="Specify url";b.alert=true;return}if(b.type===""){b.error="Specify a type";b.alert=true;return}jQuery("button").removeAttr("disabled");a.Add({url:b.url,type:b.type,visibility:b.visibility}).save(function(f){jQuery("button").attr("disabled");b.showContent(f);b.url="";b.type="";c.cache.clear()})}}]).controller("VideoList",["$scope","$routeParams","Video","$location","$http","dataStorage",function(c,e,b,g,f,d){c.selected="active";c.list=function(i){var h=d.cache.get("video.page"+i);if(h!==null){c.rows=h}else{b.List({page:i}).query(function(l){var k,j;for(k=0,j=l.length;k<j;k++){l[k]["updated_at"]=moment(l[k]["updated_at"]).fromNow()}c.rows=l;d.cache.set("video.page"+i,l)})}};c.setPage=function(){c.$watch("currentPage",function(){c.list(c.currentPage)})};c.count=function(h){f.get("/video/count").success(function(i){i=JSON.parse(i);h(i)})};c.edit=function(h){g.path("/admin/video/edit/"+h.id);d.setData(h)};c.maxSize=20;var a=d.cache.get("video.count");if(a===null){c.count(function(h){c.noOfPages=Math.ceil(h/c.maxSize);c.currentPage=1;d.cache.set("video.count",h);c.setPage()})}else{c.noOfPages=Math.ceil(a/c.maxSize);c.currentPage=1;c.setPage()}}]).controller("VideoEdit",["$scope","$routeParams","Video","$location","dataStorage",function(b,e,a,f,c){b.id="";b.title="";b.url="";b.visibility="off";b.visibilityChecked=false;b.type="";b.types=c.video.type;b.showContent=function(h){b.id=h.id;b.title=h.title;b.url=h.url;for(var g in b.types){if(b.types[g]===h.type){b.type=b.types[g];break}}if(h.visibility==1){b.visibilityChecked=true;b.visibility=true}};var d=c.getData();if(!d.id){a.Get(e).query(function(g){if(g.length===0){return}g=g[0];b.showContent(g)})}else{b.id=d.id;b.showContent(d)}b.submit=function(){a.Edit({id:b.id,title:b.title,type:b.type,visibility:b.visibility}).save(function(g){if(g.error){window.alert(g.error);return}c.cache.clear();f.path("/admin/video/list")})};b.deleteOne=function(){a.Delete({id:b.id}).save(function(g){if(!g.errors){c.cache.clear();f.path("/admin/video/list")}})}}]);